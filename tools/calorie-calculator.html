<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calorie Calculator | Daily Calorie Needs for Your Goals | EveryTool.tech</title>
    <meta name="description" content="Estimate your daily calorie needs to lose, maintain, or gain weight with our free, advanced Calorie Calculator. Includes macronutrient breakdown and multiple formulas.">
    <meta name="keywords" content="calorie calculator, macronutrient calculator, tdee calculator, daily calorie needs, weight loss calculator, diet planner, macros">
    <meta name="robots" content="index, follow">
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Advanced Calorie & Macronutrient Calculator | EveryTool.tech">
    <meta property="og:description" content="Estimate your daily calorie needs to lose, maintain, or gain weight with our free, advanced Calorie Calculator. Includes macronutrient breakdown and multiple formulas.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://everytool.tech/calorie-calculator">
    <meta property="og:image" content="https://everytool.tech/assets/tool-preview.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../assets/favicon.png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- FAQ section styling -->
    <link rel="stylesheet" href="../FAQ section/faq.css">
    <link rel="stylesheet" href="tool.css">
    <style>
        /* Custom styles for Calorie Calculator */
        .tool-display__input-section { display: flex; flex-direction: column; gap: 1.5rem; }
        .input-group-container { background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 12px; padding: 1.5rem; }
        .input-group-container h3 { margin-top: 0; margin-bottom: 1.5rem; font-size: 1.2rem; color: #343a40; display: flex; align-items: center; gap: 0.5rem; }
        .tool-display__input, .tool-display__select { width: 100%; padding: 0.75rem; border: 1px solid #ced4da; border-radius: 8px; font-size: 1rem; }
        
        .unit-switcher { display: flex; border: 1px solid #ced4da; border-radius: 8px; overflow: hidden; margin-bottom: 1rem; }
        .unit-switcher button { flex: 1; padding: 0.75rem; border: none; background: #fff; cursor: pointer; font-size: 1rem; transition: background-color 0.2s; }
        .unit-switcher button.active { background: #007bff; color: #fff; }
        .tool-display__input-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; align-items: end;}
        .height-inputs { display: flex; gap: 1rem; }
        .hidden { display: none !important; }

        .tool-display__output-section { display: flex; flex-direction: column; gap: 1.5rem; }
        .result-card { background: #fff; border: 1px solid #e9ecef; border-radius: 12px; padding: 1.5rem; text-align: center; }
        .result-card h4 { margin-top: 0; color: #007bff; font-size: 1.2rem; }
        .result-card .calorie-value { font-size: 2.5rem; font-weight: 700; color: #343a40; }
        .result-card .card-description { font-size: 0.9rem; color: #6c757d; }
        .goal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem; }
        .goal-box { background: #f8f9fa; padding: 1rem; border-radius: 8px; }
        .goal-box h5 { margin: 0 0 0.5rem 0; }

        .macros-container { text-align: left; }
        .macros-presets { margin-bottom: 1rem; }
        .macros-presets button { margin-right: 0.5rem; }
        .macro-slider-group { margin-bottom: 0.5rem; }
        .macro-slider-group label { display: block; margin-bottom: 0.25rem; }
        .macro-slider-group input[type="range"] { width: 100%; }
        .macro-chart-container { width: 100%; max-width: 250px; margin: 1.5rem auto 0 auto; }
        .disclaimer { font-size: 0.8rem; color: #6c757d; margin-top: 1rem; text-align: center;}
    </style>
</head>
<body>
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <!-- Tool Hero Section -->
    <section class="tool-hero">
        <div class="tool-hero__container">
            <div class="tool-hero__content">
                <div class="tool-hero__left">
                    <h1 class="tool-hero__title">Calorie Calculator: Fuel Your Body, Reach Your Goals</h1>
                    <p class="tool-hero__description">
                        Estimate your daily calorie and macronutrient needs to lose, maintain, or gain weight. Our advanced calculator personalizes your targets based on your goals and lifestyle.
                    </p>
                    <div class="tool-hero__features">
                        <div class="tool-feature">
                            <i class="fas fa-bullseye"></i>
                            <span>Personalized Goals</span>
                        </div>
                        <div class="tool-feature">
                            <i class="fas fa-pie-chart"></i>
                            <span>Macronutrient Splits</span>
                        </div>
                        <div class="tool-feature">
                            <i class="fas fa-dumbbell"></i>
                            <span>Multiple Formulas</span>
                        </div>
                        <div class="tool-feature">
                            <i class="fas fa-user-md"></i>
                            <span>Science-Based</span>
                        </div>
                    </div>
                    <div class="tool-hero__cta">
                        <a href="#tool-display" class="tool-button tool-button--primary">
                            <i class="fas fa-play"></i>
                            Calculate Your Calories
                        </a>
                        <a href="#learn-more" class="tool-button tool-button--secondary">
                            <i class="fas fa-book"></i>
                            Learn About Calories
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tool Display Section -->
    <section id="tool-display" class="tool-display">
        <div class="tool-display__container">
            <div class="tool-display__wrapper">
                 <div class="tool-display__header">
                    <h2 class="tool-display__title">Your Daily Nutrition Planner</h2>
                    <p class="tool-display__description">
                        Enter your details to get a science-based estimate of your daily needs.
                    </p>
                </div>
                <div class="tool-display__input-section">
                    <!-- Personal Details -->
                    <div class="input-group-container">
                        <h3><i class="fas fa-user"></i> Personal Details</h3>
                         <div class="unit-switcher">
                            <button id="btn-metric" class="active">Metric</button>
                            <button id="btn-imperial">Imperial</button>
                        </div>
                        <div class="tool-display__input-row">
                            <div class="tool-display__input-group">
                                <label class="tool-display__label">Age</label>
                                <input type="number" id="age" class="tool-display__input" value="30">
                            </div>
                             <div class="tool-display__input-group">
                                <label class="tool-display__label">Gender</label>
                                <select id="gender" class="tool-display__select">
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>
                        <div class="tool-display__input-row" style="margin-top: 1rem;">
                            <div class="tool-display__input-group">
                                <label class="tool-display__label" id="height-label">Height (cm)</label>
                                <div class="height-inputs">
                                    <input type="number" id="height-cm" class="tool-display__input" value="178">
                                    <input type="number" id="height-ft" class="tool-display__input hidden" placeholder="ft">
                                    <input type="number" id="height-in" class="tool-display__input hidden" placeholder="in">
                                </div>
                            </div>
                            <div class="tool-display__input-group">
                                <label class="tool-display__label" id="weight-label">Weight (kg)</label>
                                <input type="number" id="weight" class="tool-display__input" value="75">
                            </div>
                        </div>
                    </div>
                    <!-- Activity and Goal -->
                    <div class="input-group-container">
                         <h3><i class="fas fa-walking"></i> Activity & Goal</h3>
                         <div class="tool-display__input-row">
                             <div class="tool-display__input-group">
                                <label class="tool-display__label">Activity Level</label>
                                <select id="activity-level" class="tool-display__select">
                                    <option value="1.2">Sedentary (little or no exercise)</option>
                                    <option value="1.375">Lightly Active (light exercise/sports 1-3 days/week)</option>
                                    <option value="1.55" selected>Moderately Active (moderate exercise/sports 3-5 days/week)</option>
                                    <option value="1.725">Very Active (hard exercise/sports 6-7 days a week)</option>
                                    <option value="1.9">Extra Active (very hard exercise/physical job)</option>
                                </select>
                            </div>
                             <div class="tool-display__input-group">
                                <label class="tool-display__label">Your Goal</label>
                                <select id="goal" class="tool-display__select">
                                    <option value="maintain">Maintain Weight</option>
                                    <option value="lose">Lose Weight</option>
                                    <option value="gain">Gain Weight</option>
                                </select>
                            </div>
                         </div>
                    </div>
                    <!-- Advanced Options -->
                    <div class="input-group-container">
                         <h3><i class="fas fa-cogs"></i> Advanced (Optional)</h3>
                          <div class="tool-display__input-row">
                             <div class="tool-display__input-group">
                                <label class="tool-display__label">Body Fat %</label>
                                <input type="number" id="body-fat" class="tool-display__input" placeholder="For Katch-McArdle formula">
                            </div>
                             <div class="tool-display__input-group">
                                <label class="tool-display__label">BMR Formula</label>
                                <select id="formula" class="tool-display__select">
                                    <option value="mifflin" selected>Mifflin-St Jeor</option>
                                    <option value="harris">Harris-Benedict</option>
                                </select>
                            </div>
                          </div>
                    </div>
                     <div class="tool-display__controls">
                        <button id="calculate-btn" class="tool-display__button">
                            <i class="fas fa-magic"></i> Calculate
                        </button>
                    </div>
                </div>
                <div id="results-section" class="tool-display__output-section hidden">
                    <!-- Maintenance Card -->
                    <div class="result-card">
                        <h4>Maintenance Calories</h4>
                        <p class="card-description">The calories you need daily to maintain your current weight.</p>
                        <p class="calorie-value" id="maintenance-calories">0</p>
                        <p class="card-description">Basal Metabolic Rate (BMR): <strong id="bmr-value">0</strong></p>
                    </div>
                    <!-- Goal Cards -->
                     <div class="result-card">
                        <h4 id="goals-title">Weight Loss Goals</h4>
                         <div class="goal-grid">
                             <div class="goal-box" id="goal-mild">
                                <h5>Mild Weight Loss</h5>
                                <p class="calorie-value">0</p>
                                <p class="card-description">~0.25 kg/week</p>
                            </div>
                             <div class="goal-box" id="goal-standard">
                                <h5>Weight Loss</h5>
                                <p class="calorie-value">0</p>
                                <p class="card-description">~0.5 kg/week</p>
                            </div>
                         </div>
                    </div>
                    <!-- Macros Card -->
                    <div class="result-card macros-container">
                        <h4>Macronutrient Breakdown</h4>
                        <p class="card-description">For your chosen goal calories.</p>
                        <div class="macros-presets">
                            <button class="tool-button tool-button--secondary" data-p="25" data-c="50" data-f="25">Balanced</button>
                            <button class="tool-button tool-button--secondary" data-p="40" data-c="40" data-f="20">Zone</button>
                            <button class="tool-button tool-button--secondary" data-p="30" data-c="20" data-f="50">Low Carb</button>
                            <button class="tool-button tool-button--secondary" data-p="40" data-c="30" data-f="30">High Protein</button>
                        </div>
                        <div class="macro-chart-container">
                            <canvas id="macro-chart"></canvas>
                        </div>
                         <!-- Add detailed macro breakdown here -->
                        <div id="macro-details" style="margin-top: 1rem;"></div>
                    </div>
                </div>
            </div>
             <p class="disclaimer">These calculations are estimates based on scientific formulas. Individual needs may vary. Consult with a doctor or registered dietitian before making significant changes to your diet.</p>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="learn-more" class="tool-blog">
        <div class.blog-content>
            <div class="tool-blog__container">
                <div class="tool-blog__header">
                    <h2 class="tool-blog__title">The Ultimate Guide to Calories and Macronutrients</h2>
                    <p class="tool-blog__subtitle">
                        Learn the science behind energy balance and how to use our Calorie Calculator to create a personalized nutrition plan that works for you.
                    </p>
                </div>
                <div class="blog-section">
                    <h3 class="blog-section__title">Introduction: Calories are Not the Enemy</h3>
                    <div class="blog-section__content">
                        <p>
                           The word "calorie" often carries a negative connotation, associated with restrictive diets and guilt. But in reality, a calorie is simply a unit of energy. It's the fuel your body needs to perform every single function, from breathing and thinking to running a marathon. Understanding your personal calorie needs is the first and most crucial step toward taking control of your health, weight, and fitness goals. This is where a robust <strong>Calorie Calculator</strong> becomes an invaluable ally.
                        </p>
                        <p>
                            This guide will break down the science of energy balance in simple terms. We'll explore how your body uses calories, what factors determine your needs, and how you can manipulate your intake to achieve your goals—whether that's losing fat, building muscle, or simply maintaining a healthy weight. We'll also dive into macronutrients, showing you how our calculator can help you build a balanced and sustainable eating plan.
                        </p>
                    </div>
                </div>

                <div class="blog-section">
                    <h3 class="blog-section__title">Your Body's Energy Equation: TDEE Explained</h3>
                    <div class="blog-section__content">
                        <p>
                           The "maintenance calories" our calculator provides is an estimate of your Total Daily Energy Expenditure (TDEE). This is the total number of calories you burn in a 24-hour period. TDEE is made up of several components:
                        </p>
                        <ul>
                            <li>
                                <strong>Basal Metabolic Rate (BMR):</strong> This is the energy your body burns at complete rest to keep vital functions running (like your heart, lungs, and brain). It's the largest portion of your TDEE. Our calculator shows you this number separately. The most accurate formulas for BMR, like Mifflin-St Jeor (our default), consider your age, gender, height, and weight.
                            </li>
                             <li>
                                <strong>Thermic Effect of Food (TEF):</strong> The calories burned during the digestion and absorption of food.
                            </li>
                            <li>
                                <strong>Non-Exercise Activity Thermogenesis (NEAT):</strong> Energy expended for everything we do that is not sleeping, eating, or sports-like exercise. This includes walking to your car, typing, and even fidgeting.
                            </li>
                            <li>
                                <strong>Exercise Activity Thermogenesis (EAT):</strong> The calories you burn during intentional exercise. The "Activity Level" you select in the calculator acts as a multiplier on your BMR to account for both EAT and NEAT.
                            </li>
                        </ul>
                        <p>Your TDEE is the baseline. To lose weight, you need to consume fewer calories than your TDEE (a calorie deficit). To gain weight, you need to consume more (a calorie surplus).</p>
                    </div>
                </div>
                
                 <div class="blog-section">
                    <h3 class="blog-section__title">Beyond Calories: The Importance of Macronutrients</h3>
                    <div class="blog-section__content">
                        <p>
                           While the total number of calories determines weight change, the *source* of those calories—macronutrients—affects body composition, satiety, and overall health. There are three primary macronutrients:
                        </p>
                         <ul>
                            <li><strong>Protein (4 calories per gram):</strong> Essential for building and repairing tissues, including muscle. It is also the most satiating macronutrient, helping you feel full and satisfied.</li>
                            <li><strong>Carbohydrates (4 calories per gram):</strong> The body's primary and most easily accessible source of energy. They fuel your brain and your workouts.</li>
                            <li><strong>Fats (9 calories per gram):</strong> Crucial for hormone production, vitamin absorption, and brain health. Fats are energy-dense and play a key role in a balanced diet.</li>
                        </ul>
                        <p>Our <strong>Calorie Calculator</strong> not only gives you a calorie target but also breaks it down into grams of protein, carbs, and fats. You can use our presets (like "Balanced" or "Low Carb") or customize the ratios to fit your personal preference and goals.</p>
                    </div>
                </div>

                <div class="blog-section">
                    <h3 class="blog-section__title">Using the Advanced Features for Pinpoint Accuracy</h3>
                    <div class="blog-section__content">
                        <p>
                           For those who want to take their planning to the next level, our calculator offers advanced options:
                        </p>
                        <ol>
                            <li>
                                <strong>Body Fat Percentage (Katch-McArdle Formula):</strong> Standard formulas like Mifflin-St Jeor are great for the general population. However, they can underestimate the calorie needs of very lean, muscular individuals. If you know your body fat percentage, inputting it allows the calculator to use the Katch-McArdle formula. This formula bases your BMR on your *lean body mass* instead of your total weight, providing a much more accurate estimate for athletic individuals.
                            </li>
                            <li>
                                <strong>Formula Options (Mifflin vs. Harris-Benedict):</strong> The Mifflin-St Jeor formula is considered the most accurate for most people. However, the Harris-Benedict formula is a classic and is still widely used. We provide it as an option so you can compare the results. If they are close, you can be more confident in your target. If they differ, it's often best to stick with the Mifflin-St Jeor estimate.
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="blog-section">
                    <h3 class="blog-section__title">Putting It All Together: Creating Your Plan</h3>
                    <div class="blog-section__content">
                       <p>Here's a step-by-step approach to using the calculator:</p>
                       <ol>
                           <li><strong>Get Your Baseline:</strong> Enter your details and select "Maintain Weight" as your goal. The result is your estimated TDEE. This is your starting point.</li>
                           <li><strong>Set a Realistic Goal:</strong> Choose your primary goal (lose, gain, or maintain). For weight loss, the calculator will provide targets for a mild deficit (~250 calories) and a standard deficit (~500 calories). A 500-calorie daily deficit generally leads to about 1 lb (0.5 kg) of weight loss per week, which is a sustainable and recommended rate.</li>
                           <li><strong>Choose Your Macro Split:</strong> Select a macronutrient preset that aligns with your dietary preferences. If you're new to this, "Balanced" is a great place to start. If you're very active, "High Protein" might be beneficial.</li>
                           <li><strong>Be Consistent and Patient:</strong> The numbers from the calculator are a starting point. Your real-world results are the ultimate feedback. Stick to your target calories and macros for 2-3 weeks and monitor your weight. If you're not seeing the expected results, you can make small adjustments (e.g., reduce or increase calories by 100-200) and assess again.</li>
                       </ol>
                    </div>
                </div>

                <div class="blog-section">
                    <h3 class="blog-section__title">Conclusion: Knowledge is Power</h3>
                    <div class="blog-section__content">
                        <p>
                           Tracking calories and macros isn't about restriction; it's about awareness and control. It transforms nutrition from a guessing game into a predictable system. By understanding the energy your unique body requires, you can make informed decisions that align with your goals.
                        </p>
                        <p>
                            Use our <strong>Calorie Calculator</strong> as your personal nutrition guide. Experiment with different scenarios, find a plan that feels sustainable, and embark on your health and fitness journey with the confidence that comes from having a data-driven plan.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section">
        <div class="faq-container">
            <div class="faq-header">
                <h2 class="faq-title">Frequently Asked Questions</h2>
                <p class="faq-subtitle">Answering common questions about calories and nutrition.</p>
            </div>
            <div class="faq-list">
                <div class="faq-item">
                    <div class="faq-question">
                        What is the most accurate calorie calculator formula?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>For the general population, the Mifflin-St Jeor formula is considered the most accurate and is the default in our calculator. For individuals with a known body fat percentage (especially athletes), the Katch-McArdle formula, which uses lean body mass, provides a more precise estimate.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        How many calories should I eat to lose 1 kg (or 1 lb) per week?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>A kilogram of body fat is roughly 7,700 calories, while a pound is about 3,500 calories. To lose 1 lb/week, you'd need a deficit of ~500 calories per day (3500/7). To lose 1 kg/week, you'd need a deficit of ~1100 calories per day (7700/7), which is very aggressive and not recommended for most people. A safer goal is 0.5 kg/week, requiring a ~550 calorie deficit.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        Should I eat the same number of calories on rest days and workout days?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>The activity multipliers in our calculator average your energy expenditure over the week. For simplicity and consistency, most people find it easiest to eat the same number of calories each day. The weekly energy balance is what matters most for weight change.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        What are macronutrients (macros)?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Macronutrients are the nutrients your body needs in large amounts to provide energy: protein, carbohydrates, and fats. Our calculator breaks down your total calorie goal into grams of each macro to help you build a balanced diet.</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        Do I need to hit my macros perfectly every day?
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>No, perfection isn't necessary. The goal is consistency, not perfection. Aim to be within a reasonable range of your targets (e.g., +/- 10-20 grams for each macro). Prioritize hitting your total calorie and protein goals, as these have the biggest impact on weight management and body composition.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <script>
        // Fetch and insert header/footer
        document.addEventListener('DOMContentLoaded', () => {
            fetch('../../header.html').then(r => r.text()).then(h => document.getElementById('header-placeholder').innerHTML = h);
            fetch('../../footer.html').then(r => r.text()).then(h => document.getElementById('footer-placeholder').innerHTML = h);
        });

        // Calorie Calculator Logic
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const inputs = {
                btnMetric: document.getElementById('btn-metric'),
                btnImperial: document.getElementById('btn-imperial'),
                age: document.getElementById('age'),
                gender: document.getElementById('gender'),
                heightCm: document.getElementById('height-cm'),
                heightFt: document.getElementById('height-ft'),
                heightIn: document.getElementById('height-in'),
                weight: document.getElementById('weight'),
                activity: document.getElementById('activity-level'),
                goal: document.getElementById('goal'),
                bodyFat: document.getElementById('body-fat'),
                formula: document.getElementById('formula'),
                calculateBtn: document.getElementById('calculate-btn'),
            };

            const outputs = {
                resultsSection: document.getElementById('results-section'),
                maintenance: document.getElementById('maintenance-calories'),
                bmr: document.getElementById('bmr-value'),
                goalsTitle: document.getElementById('goals-title'),
                goalMild: document.getElementById('goal-mild').querySelector('.calorie-value'),
                goalMildDesc: document.getElementById('goal-mild').querySelector('.card-description'),
                goalStandard: document.getElementById('goal-standard').querySelector('.calorie-value'),
                goalStandardDesc: document.getElementById('goal-standard').querySelector('.card-description'),
                macroDetails: document.getElementById('macro-details'),
            };

            let currentUnit = 'metric';
            let macroChart;

            // --- Unit Switching ---
            function setUnits(unit) {
                currentUnit = unit;
                const heightLabel = document.getElementById('height-label');
                const weightLabel = document.getElementById('weight-label');
                if (unit === 'metric') {
                    inputs.btnMetric.classList.add('active');
                    inputs.btnImperial.classList.remove('active');
                    inputs.heightCm.classList.remove('hidden');
                    inputs.heightFt.classList.add('hidden');
                    inputs.heightIn.classList.add('hidden');
                    heightLabel.textContent = 'Height (cm)';
                    weightLabel.textContent = 'Weight (kg)';
                } else {
                    inputs.btnMetric.classList.remove('active');
                    inputs.btnImperial.classList.add('active');
                    inputs.heightCm.classList.add('hidden');
                    inputs.heightFt.classList.remove('hidden');
                    inputs.heightIn.classList.remove('hidden');
                    heightLabel.textContent = 'Height (ft, in)';
                    weightLabel.textContent = 'Weight (lbs)';
                }
            }
            inputs.btnMetric.addEventListener('click', () => setUnits('metric'));
            inputs.btnImperial.addEventListener('click', () => setUnits('imperial'));

            // --- Main Calculation ---
            inputs.calculateBtn.addEventListener('click', () => {
                // 1. Get and normalize inputs
                const age = parseInt(inputs.age.value);
                const gender = inputs.gender.value;
                const activityMultiplier = parseFloat(inputs.activity.value);
                const bodyFat = parseFloat(inputs.bodyFat.value);
                const formula = inputs.formula.value;

                let heightCm, weightKg;
                if (currentUnit === 'metric') {
                    heightCm = parseFloat(inputs.heightCm.value);
                    weightKg = parseFloat(inputs.weight.value);
                } else {
                    const ft = parseFloat(inputs.heightFt.value) || 0;
                    const inch = parseFloat(inputs.heightIn.value) || 0;
                    heightCm = ((ft * 12) + inch) * 2.54;
                    weightKg = parseFloat(inputs.weight.value) * 0.453592;
                }
                
                if (isNaN(age) || isNaN(heightCm) || isNaN(weightKg) || age <=0 || heightCm <= 0 || weightKg <= 0) {
                    alert('Please fill in all required fields with valid numbers.');
                    return;
                }

                // 2. Calculate BMR
                let bmr = 0;
                if (!isNaN(bodyFat) && bodyFat > 0) { // Katch-McArdle
                    const leanBodyMass = weightKg * (1 - (bodyFat / 100));
                    bmr = 370 + (21.6 * leanBodyMass);
                } else if (formula === 'mifflin') { // Mifflin-St Jeor
                    bmr = (10 * weightKg) + (6.25 * heightCm) - (5 * age) + (gender === 'male' ? 5 : -161);
                } else { // Harris-Benedict
                    if(gender === 'male') {
                        bmr = 88.362 + (13.397 * weightKg) + (4.799 * heightCm) - (5.677 * age);
                    } else {
                        bmr = 447.593 + (9.247 * weightKg) + (3.098 * heightCm) - (4.330 * age);
                    }
                }
                
                // 3. Calculate TDEE (Maintenance Calories)
                const maintenanceCalories = Math.round(bmr * activityMultiplier);
                
                // 4. Update UI
                outputs.resultsSection.classList.remove('hidden');
                outputs.maintenance.textContent = maintenanceCalories.toLocaleString();
                outputs.bmr.textContent = Math.round(bmr).toLocaleString();
                
                updateGoalCalories(maintenanceCalories);
            });

            // --- Update Goal and Macro sections ---
            function updateGoalCalories(maintenance) {
                const goal = inputs.goal.value;
                let mildGoal, standardGoal, targetCalories;
                const mildDesc = currentUnit === 'metric' ? '~0.25 kg/week' : '~0.5 lbs/week';
                const standardDesc = currentUnit === 'metric' ? '~0.5 kg/week' : '~1 lb/week';

                if(goal === 'lose') {
                    outputs.goalsTitle.textContent = 'Weight Loss Goals';
                    mildGoal = maintenance - 250;
                    standardGoal = maintenance - 500;
                    outputs.goalMildDesc.textContent = mildDesc;
                    outputs.goalStandardDesc.textContent = standardDesc;
                    targetCalories = standardGoal;
                } else if (goal === 'gain') {
                    outputs.goalsTitle.textContent = 'Weight Gain Goals';
                    mildGoal = maintenance + 250;
                    standardGoal = maintenance + 500;
                    outputs.goalMildDesc.textContent = mildDesc.replace('Loss', 'Gain');
                    outputs.goalStandardDesc.textContent = standardDesc.replace('Loss', 'Gain');
                    targetCalories = standardGoal;
                } else { // Maintain
                    outputs.goalsTitle.textContent = 'Maintenance';
                    mildGoal = maintenance;
                    standardGoal = maintenance;
                    outputs.goalMildDesc.textContent = 'Stay at current weight';
                    outputs.goalStandardDesc.textContent = '';
                    targetCalories = maintenance;
                }

                outputs.goalMild.textContent = Math.round(mildGoal).toLocaleString();
                outputs.goalStandard.textContent = Math.round(standardGoal).toLocaleString();
                
                // Default to balanced macro split
                calculateMacros(targetCalories, 25, 50, 25);
            }
            
            // --- Macro Calculation & Charting ---
            function calculateMacros(calories, p, c, f) {
                const proteinGrams = Math.round((calories * (p/100)) / 4);
                const carbsGrams = Math.round((calories * (c/100)) / 4);
                const fatGrams = Math.round((calories * (f/100)) / 9);

                outputs.macroDetails.innerHTML = `
                    <p><strong>Protein:</strong> ${proteinGrams}g</p>
                    <p><strong>Carbs:</strong> ${carbsGrams}g</p>
                    <p><strong>Fat:</strong> ${fatGrams}g</p>
                `;
                
                drawMacroChart(proteinGrams, carbsGrams, fatGrams);
            }
            
            function drawMacroChart(p, c, f) {
                if(macroChart) macroChart.destroy();
                
                const ctx = document.getElementById('macro-chart').getContext('2d');
                macroChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Protein', 'Carbs', 'Fat'],
                        datasets: [{
                            data: [p * 4, c * 4, f * 9], // Data in calories
                            backgroundColor: ['#36A2EB', '#FFCE56', '#FF6384'],
                            hoverBackgroundColor: ['#36A2EB', '#FFCE56', '#FF6384']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: { position: 'top' },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        const value = context.raw;
                                        const total = context.chart.getDatasetMeta(0).total;
                                        const percentage = ((value / total) * 100).toFixed(0);
                                        return `${label} ${percentage}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Event listener for macro presets
            document.querySelectorAll('.macros-presets button').forEach(button => {
                button.addEventListener('click', () => {
                    const p = parseFloat(button.dataset.p);
                    const c = parseFloat(button.dataset.c);
                    const f = parseFloat(button.dataset.f);
                    let targetCalories;
                    const maintenance = parseFloat(outputs.maintenance.textContent.replace(/,/g, ''));
                    const goal = inputs.goal.value;

                    if (goal === 'lose') targetCalories = maintenance - 500;
                    else if (goal === 'gain') targetCalories = maintenance + 500;
                    else targetCalories = maintenance;

                    calculateMacros(targetCalories, p, c, f);
                });
            });

            // Listen for changes on goal dropdown to update macros
            inputs.goal.addEventListener('change', () => {
                 if(!outputs.resultsSection.classList.contains('hidden')) {
                    const maintenance = parseFloat(outputs.maintenance.textContent.replace(/,/g, ''));
                    updateGoalCalories(maintenance);
                 }
            });

            // Initial state
            setUnits('metric');

        });

    </script>
    <script src="../FAQ section/faq.js"></script>
    <script src="../view.js"></script>

    <script>
        // =====================================================================
        // ====== START: MAGIC BLOCK TO COPY FOR EVERY NEW PAGE ======
        // =====================================================================
            document.addEventListener('DOMContentLoaded', () => {
        
        const loadScript = (src) => {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => resolve(script);
                script.onerror = () => reject(new Error(`Script load error for ${src}`));
                document.body.appendChild(script);
            });
        };
        
        const loadHeader = () => {
            const headerPlaceholder = document.getElementById('header-placeholder');
            if (!headerPlaceholder) return;
        
            // *** IMPORTANT: ADJUST THIS PATH BASED ON YOUR FILE'S LOCATION ***
            fetch('/header.html') 
                .then(response => {
                    if (!response.ok) throw new Error('Network response for header.html was not ok.');
                    return response.text();
                })
                .then(html => {
                    headerPlaceholder.innerHTML = html;
                    return loadScript('https://cdn.jsdelivr.net/npm/fuse.js@6.6.2');
                })
                .then(() => {
                    // *** IMPORTANT: ADJUST THIS PATH BASED ON YOUR FILE'S LOCATION ***
                    return loadScript('/header-search.js');
                })
                .then(() => {
                    if (typeof initializeHeader === 'function') {
                        initializeHeader(); 
                    } else {
                        throw new Error('initializeHeader function not found.');
                    }
                })
                .catch(error => {
                    console.error('CRITICAL ERROR during header loading process:', error);
                });
        };
        
        const loadFooter = () => {
            const footerPlaceholder = document.getElementById('footer-placeholder');
            if (footerPlaceholder) {
                // *** IMPORTANT: ADJUST THIS PATH BASED ON YOUR FILE'S LOCATION ***
                fetch('/footer.html')
                    .then(response => response.ok ? response.text() : Promise.reject('Failed to load footer'))
                    .then(html => { footerPlaceholder.innerHTML = html; })
                    .catch(error => console.error('Error loading footer:', error));
            }
        };
        
        loadHeader();
        loadFooter();
        });
        
            </script>
</body>
</html>